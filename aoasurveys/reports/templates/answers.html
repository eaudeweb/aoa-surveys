{% extends '_layout.html' %}
{% load assets %}
{% load extra_tags %}

{% block scripts %}
  <script>
    $(document).ready(function () {
      var dataTable = $('#answers-listing').dataTable({
        "processing": true,
        "serverSide": true,
        "ajax": "{% url 'answers_data'  object.slug %}"
      });

      $('#searchbox').keyup(function () {
        dataTable.fnFilter(this.value);
      });
    });
  </script>

  {% if custom_js %}
    {% assets filters="jsmin", output="custom_packed.js", custom_js %}
      <script type="text/javascript" src="{{ ASSET_URL }}"></script>
    {% endassets %}
  {% endif %}

{% endblock %}

{% block content %}
  <h2>{{ object.title | translate:request.language }}</h2>

  <div class="search-form">
    <label>Search:
      <input id="searchbox" type="text">
    </label>

    <a href="" id="advanced-filtering-button">{% if advanced_enabled %}Hide
      advanced filtering{% else %}Advanced filtering{% endif %}</a>

    <table id="advanced-filtering-form"
           {% if not advanced_enabled %}style="display: none;"{% endif %}>
      <form action="" method="POST">{% csrf_token %}
        {{ form.as_table }}
        <tr>
          <td><input type="submit" value="Filter"/></td>
        </tr>
      </form>
    </table>
  </div>

  <table id="answers-listing" class="table table-condensed table-bordered">
    <thead>
    <tr>
      {% for field in object.visible_fields %}
        <th>{{ field.label | translate:request.language }}</th>
      {% endfor %}
    </tr>
    </thead>
  </table>
{% endblock %}
